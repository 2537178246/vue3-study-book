# å‰ç«¯æŠ€æœ¯åŠç»“æ„æ‰‹å†Œ

è¯¥æ‰‹å†Œé€‚ç”¨äºå‰ç«¯vue3é¡¹ç›®æ¨¡ç‰ˆ

æ˜ç¡®é¡¹ç›®æ–‡ä»¶ç»“æ„è§„èŒƒ
## æŠ€æœ¯æ¡†æ¶
Vue3-Vite-TypeScript-Pinia-TailwindCss

### **Vue3**

  Vue (å‘éŸ³ä¸º **/vjuË/**ï¼Œç±»ä¼¼ view) æ˜¯ä¸€æ¬¾ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript æ¡†æ¶ã€‚å®ƒåŸºäºæ ‡å‡† HTMLã€CSS å’Œ JavaScript æ„å»ºï¼Œå¹¶æä¾›äº†ä¸€å¥—å£°æ˜å¼çš„ã€ç»„ä»¶åŒ–çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¸®åŠ©ä½ é«˜æ•ˆåœ°å¼€å‘ç”¨æˆ·ç•Œé¢ã€‚æ— è®ºæ˜¯ç®€å•è¿˜æ˜¯å¤æ‚çš„ç•Œé¢ï¼ŒVue éƒ½å¯ä»¥èƒœä»»ã€‚
  
  [å‰å¾€å®˜ç½‘](https://cn.vuejs.org/)

  [å°çŸ¥è¯†é˜…è¯»](/v3)
### **Vite**
  
  ç‰ˆæœ¬ï¼ˆV2ï¼‰,åç»­è€ƒè™‘å‡çº§V3

  æœ€ä½Nodeç‰ˆæœ¬ ğŸ‘‰ <Badge type="tip" text="14.18" vertical="middle" />

  Viteï¼ˆæ³•è¯­æ„ä¸º "å¿«é€Ÿçš„"ï¼Œå‘éŸ³ **/vit/**ï¼Œå‘éŸ³åŒ "veet"ï¼‰æ˜¯ä¸€ç§æ–°å‹å‰ç«¯æ„å»ºå·¥å…·ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å‰ç«¯å¼€å‘ä½“éªŒã€‚

  [å‰å¾€å®˜ç½‘](https://v2.vitejs.dev/)
### **TypeScript**

  <span style="color: #f3a22b;font-size: 24px;">JavaScriptçš„è¶…é›†</span>

  TypeScriptæ˜¯JavaScriptç±»å‹çš„è¶…é›†ï¼Œå®ƒå¯ä»¥ç¼–è¯‘æˆçº¯JavaScriptã€‚

  TypeScriptå¯ä»¥åœ¨ä»»ä½•æµè§ˆå™¨ã€ä»»ä½•è®¡ç®—æœºå’Œä»»ä½•æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ˜¯å¼€æºçš„ã€‚

  [å°çŸ¥è¯†é˜…è¯»](/ts)

  [å‰å¾€å®˜ç½‘](https://www.tslang.cn/)
### **Pinia**

  Piniaï¼ˆå‘éŸ³ä¸º **/piËnjÊŒ/**ï¼Œç±»ä¼¼äºè‹±è¯­ä¸­çš„â€œpeenyaâ€ï¼‰æ˜¯æœ€æ¥è¿‘æœ‰æ•ˆåŒ…å piÃ±aï¼ˆè¥¿ç­ç‰™è¯­ä¸­çš„_pineapple_ï¼‰çš„è¯ã€‚ è èå®é™…ä¸Šæ˜¯ä¸€ç»„å•ç‹¬çš„èŠ±æœµï¼Œå®ƒä»¬ç»“åˆåœ¨ä¸€èµ·å½¢æˆå¤šä¸ªæ°´æœã€‚ ä¸ Store ç±»ä¼¼ï¼Œæ¯ä¸€å®¶éƒ½æ˜¯ç‹¬ç«‹è¯ç”Ÿçš„ï¼Œä½†æœ€ç»ˆéƒ½æ˜¯ç›¸äº’è”ç³»çš„ã€‚ å®ƒä¹Ÿæ˜¯ä¸€ç§ç¾å‘³çš„çƒ­å¸¦æ°´æœï¼ŒåŸäº§äºå—ç¾æ´²ã€‚

  [å‰å¾€å®˜ç½‘](https://pinia.web3doc.top/)
### **TailwindCss**

  ç›¸å¯¹äº**è¯­ä¹‰åŒ–ç±»å**ï¼ŒåŸå­åŒ–Cssèƒ½å¤Ÿå¿«é€Ÿå»ºç«‹ç°ä»£ç½‘ç«™ã€‚

  [å‰å¾€å®˜ç½‘](https://www.tailwindcss.cn/docs)
## ç»„ä»¶åº“
element-plus(element-uiçš„vue3ç‰ˆæœ¬)
https://element-plus.gitee.io/zh-CN/component/button.html

## å®‰è£…ä¸ä½¿ç”¨
1. åˆ›å»ºgit
   Project path:front/2022(2022ä¸ºé¡¹ç›®åˆ›å»ºå¹´ä»½ï¼Œ2023å¹´åˆ™æ”¹ä¸º2023)
   New subgroup  åˆ›å»ºé¡¹ç›®gitç»„ï¼ˆä½¿ç”¨ä¸²å¼å‘½åï¼Œä¾‹å¦‚hubei-liveï¼‰description  é¡¹ç›®å…¨ç§°

2. ä»£ç æ¨¡æ¿
   åŸºç¡€æ¨¡æ¿ https://hxgit.hxgis.com/front/vue3-template.git
   ä¸‰ç»´æ¨¡æ¿ https://hxgit.hxgis.com/front/2022/vite-3d-templateï¼ˆå¾…å®Œå–„ï¼‰

3. forkæ¨¡æ¿ä»£ç 
   ä» [GIT](https://hxgit.hxgis.com/front/vue3-template.git) ä¸Š `fork` (æ´¾ç”Ÿ) ä¸ªæ–°é¡¹ç›®åˆ°åˆšå»ºçš„é¡¹ç›®å­ç¾¤ç»„é‡Œ, ç„¶åè¿›è¡Œé‡å‘½å. **(æ³¨æ„: `Project name` å’Œ `Path` éƒ½è¦æ”¹.)**
   Project name:ä½¿ç”¨ä¸²å¼å‘½åï¼ˆç¬¬ä¸€ä¸ªä¸ºé¡¹ç›®åœ°åŒº ä¾‹å¦‚ hubei-live-trafficï¼‰
   Project description (optional): ç³»ç»Ÿåç§°


4. npm install

5. npm run dev

6. æ ¼å¼åŒ–é…ç½®
   IDEå·¥å…·ï¼šwebstorm
   è®¾ç½®->è¯­è¨€å’Œæ¡†æ¶->javascript->ä»£ç è´¨é‡å·¥å…·->ESLint
   å‹¾é€‰ä¿å­˜æ—¶è¿è¡Œ

1. ç¼–å†™REDEME.mdæ–‡æ¡£
```
 é¡¹ç›®åç§°ğŸ‘‡
  æ¹–åŒ—äº¤é€šæ°”è±¡æœåŠ¡é¡¹ç›®
 ç³»ç»Ÿåç§°ğŸ‘‡
 	äº§å“æ˜¾ç¤ºç³»ç»Ÿ

- å¯åŠ¨æ—¶é—´ğŸ‘‡
  2022-10-17

- å¼€å‘äººå‘˜ğŸ‘‡

    - é¡¹ç›®ç»ç†
      å€™åè™
    - å‰ç«¯
      ä½™ä»¥åŠŸã€é»„é›¯ã€æ¢…é˜³
    - åç«¯
      ç‹è£ç¿°ã€å†¯å¸†ã€å‘¨å¤ã€è¢é¾™é£

- swagger åœ°å€ğŸ‘‡
  http://10.104.95.20:8077/hbjt/doc.html#/default/%E5%A4%A9%E6%B0%94%E8%AF%A6%E6%83%85%E8%BD%AC%E5%8F%91/getWeatherByTimeRangeUsingGET

- çº¿ä¸Šåœ°å€ğŸ‘‡


- jenkins åœ°å€ğŸ‘‡


- ç™»å½•è´¦å·-å¯†ç ğŸ‘‡

```
## é¡¹ç›®ç»“æ„
```
--public
--src
	|--api
  |--assets
  |--components
  |--hooks
  |--i18n
  |--services
  |--store
  |--types
  |--view
  App.vue
  config.json
  env.d.ts
  main.ts
  permission.ts
  router.ts
.env.development
.env.production
.eslintignore
.eslintrc.js
.gitignore
env.d.ts
index.html
package.json
README.md
tsconfig.json
vite.config.ts
```

## é¡¹ç›®ç»“æ„æè¿°
### publicæ–‡ä»¶å¤¹
é™æ€èµ„æºæ–‡ä»¶ï¼Œå­˜æ”¾çš„æ–‡ä»¶ä¸ä¼šç»è¿‡viteå¤„ç†ï¼Œå­˜æ”¾geojsonæˆ–è€…ç¬¬ä¸‰æ–¹jsæ’ä»¶

### srcæ–‡ä»¶å¤¹

#### api æ¥å£ç®¡ç†æ–‡ä»¶å¤¹
1. æ–‡ä»¶å‘½åæŒ‰ç…§viewæ¨¡å—å‘½åï¼Œå±‚çº§æœ€å¤šä¸è¶…è¿‡2å±‚ï¼Œ
1. å®šä¹‰çš„æ¥å£å‡½æ•°ï¼ˆé»˜è®¤åç«¯æ¥å£åç§°ä¿æŒä¸€è‡´ï¼‰ï¼Œå¦‚æœæ¥å£åç§°ä¸è§„èŒƒï¼Œå‰ç¼€åŠ æ¨¡å—åç§°
1. å‚æ•°typeå®šä¹‰ç±»å‹
1. æ¥å£æ³¨é‡Šï¼ˆé»˜è®¤ä¸æ¥å£æ–‡æ¡£ä¸€è‡´ï¼‰
```typescript
/**
 * è·å–åŸå¸‚åœ°å€
 * @param params
 */
export const getOnceArea = (params: {
  cityCode: string,
  dataType: string,
  dataName: string,
}) => tRequest.get({
  url: '/api/monitor/dataflow/getOnceArea',
  params
})

/**
 * ä¸Šä¼ å•å¼ å›¾ç‰‡ä¸ºpptå†…å®¹
 * @param data
 */
export const uploadImage = (data: {
  file:File
})=> {
  tRequest.post({
    url: '/ppt/pptModelConfigs/uploadImage',
    data
  })
}
```

##### æ¥å£å‚æ•°
showLoading å…¨å±åŠ è½½åŠ¨ç”»ï¼Œé»˜è®¤ä¸ºtrue
useCompress å‹ç¼©å“åº”æ•°æ®
useCompressWithCache å‹ç¼©å¹¶ç¼“å­˜å“åº”æ•°æ®



#### assets
é™æ€èµ„æº
1. æ–‡ä»¶å¤¹cssã€imgã€jsonã€fontç­‰
1. imgä¸json å­˜æ”¾ä½ç½®æŒ‰ç…§viewç›®å½•ç»“æ„ä¸€ä¸€å¯¹åº”å­˜æ”¾
1. å…¬å…±èµ„æºå¦‚é¢„è­¦å›¾ç‰‡å•ç‹¬åœ¨imgæ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶å¤¹å­˜æ”¾

#### components
1.ä¸€ä¸ªç»„ä»¶ä¸€ä¸ªæ–‡ä»¶å¤¹
2.ç»„ä»¶éœ€è¦çš„é™æ€èµ„æºå­˜æ”¾åˆ°æ–‡ä»¶å¤¹ä¸‹ï¼ˆä¾‹å¦‚imgï¼‰

#### hooks
> Hooks -> é’©å­

- Hookså¹¶ä¸æ˜¯å…¨æ–°çš„æŠ€æœ¯ï¼Œå®ƒæ˜¯ä¸€ç§å¼€å‘æ€æƒ³ï¼Œåœ¨hooksç›®å½•ä¸‹æ–°å»ºæ¨¡å—->useXXX.ts
- å¯ä»¥åˆ©ç”¨Hookå‡½æ•° æŠŠç›¸å…³ä»£ç å‰¥ç¦»å‡ºå»ï¼Œå‡å°‘å†—ä½™ä»£ç 
- Hooks å‡½æ•°ä»¥useå¼€å¤´ï¼ˆç±»ä¼¼vue2 mixin $_XX_XXï¼‰å°é©¼å³°å¼å‘½åï¼šuseFileHome
- å¤ç”¨ **é«˜å†…èšä½è€¦åˆ** å¯å¡‘æ€§é«˜

ä¾‹ä¸€
```typescript
import config from '../../config.json'

export const useStorage = new class {
  private readonly _localName: string;
  constructor(localName: string) {
    this._localName = localName
  }
  getStorage() {
    return JSON.parse(window.localStorage.getItem(this._localName)) || {}
  }
  setItem(key: string, val: any) {
    const storage = this.getStorage()
    storage[key] = val
    window.localStorage.setItem(this._localName, JSON.stringify(storage))
  }
  clearItem(key: string) {
    const storage = this.getStorage()
    delete storage[key]
    window.localStorage.setItem(this._localName, JSON.stringify(storage))
  }
  clearAll() {
    window.localStorage.clear()
  }
}(config.LocalName)
// const useStorage = new UseStorage
```
--> use
```typescript
import { useStorage } from '@/hooks'

useStorage.setItem('userinfo', data)
useStorage.clearAll()
```

ä¾‹äºŒ
```typescript
import { computed, getCurrentInstance } from 'vue'
import type { ComputedRef } from 'vue'

export const useProp = <T>(name: string): ComputedRef<T | undefined> => {
  const vm = getCurrentInstance()!
  return computed(() => (vm.proxy?.$props as any)[name] ?? undefined)
}
```
--> use
```typescript
import { useProp } from '@/hooks'

const props = withDefaults(defineProps<{
  button: string
}>(), {
  button: ''
})
const button = useProp<string>('button')
```

æ›´å¤šå·¥å…·hooksè¯·è®¿é—® --> [VueUse](https://vueuse.org/)

#### types tsç±»å‹å®šä¹‰
æ–‡ä»¶åç§°ä¸viewç›®å½•ä¸€è‡´ï¼Œç›®å½•ç»“æ„ä¸è¶…è¿‡ä¸¤å±‚ï¼ŒæŒ‰ç…§è·¯ç”±ç›®å½•åˆ›å»º
æœ€ç»ˆç»Ÿä¸€åœ¨index.tsä¸­æš´éœ²
åœ¨å…¶ä»–é¡¹ç›®ä¸­ importå¼•å…¥ä½¿ç”¨

typescriptçš„ç›®çš„æ˜¯æå‡ä»£ç è´¨é‡ï¼Œæå‡å¯ç»´æŠ¤æ€§
```typescript
export interface LoginType {
  username?: string,
  password?: string
}
```

> æ³¨æ„

vue3 prop æš‚ä¸æ”¯æŒ å¤–éƒ¨å¼•å…¥type

é”™è¯¯ç¤ºä¾‹
```typescript
import { LoginType } from 'types'

const props = withDefaults(defineProps<LoginType>(), {
  username: 'ç« ä¸‰',
  passwoard: '123'
})

// or

const props = defineProps<LoginType>({
  username: 'ç« ä¸‰',
  passwoard: '123'
})

/** 
[@vue/compiler-sfc] type argument passed to defineProps() must be a literal type, or a reference to an interface or literal type.
**/
```

æ­£ç¡®ç¤ºä¾‹
```typescript
interface LoginType {
  username?: string,
  password?: string
}

const props = withDefaults(defineProps<LoginType>(), {
  username: 'ç« ä¸‰',
  passwoard: '123'
})

// or

const props = withDefaults(defineProps<{
  username?: string,
  passwoard: string
}>(), {
  username: 'ç« ä¸‰',
  passwoard: '123'
})


// æ³¨ï¼šè¯·ä½¿ç”¨withDefaultsæ¥è¿›è¡Œpropsä¼ å€¼
```

å­¦ä¹ å¦‚ä½•ä½¿ç”¨TypeScript? --> [TypeScript](https://www.tslang.cn/)

#### store
ä½¿ç”¨piniaæ’ä»¶ https://pinia.web3doc.top/
ç›®å½•ç»“æ„æŒ‰ç…§viewç›®å½•åˆ›å»º

#### i18n å›½é™…åŒ–
->æ•°æ®å­—å…¸å®šä¹‰
æ•°æ®å­—å…¸æŒ‰ç…§é¡µé¢æ¨¡å—åˆ’åˆ†ï¼ˆä¾‹å¦‚home\monitor2ä¸ªæ¨¡å—ï¼‰
```typescript
// ä¸­æ–‡è¯­è¨€åŒ…ï¼š\src\i18n\lang\zh-cn.ts
export default {
  home: {
    name: 'è¿™æ˜¯é¦–é¡µ'
  },
  monitor: {
    name: 'è¿™æ˜¯ç›‘æµ‹'
  }
}
// è‹±æ–‡è¯­è¨€åŒ…ï¼š\src\i18n\lang\en.ts
export default {
  home: {
    name: 'this is home'
  }
}
```
->ä½¿ç”¨
```typescript
import { useI18n } from 'vue-i18n'// è¦åœ¨jsä¸­ä½¿ç”¨å›½é™…åŒ–
const { t } = useI18n()
 t('home.name')
```
->ä¸­è‹±æ–‡åˆ‡æ¢
```typescript
import i18n from â€™@/i18nâ€˜
i18n.locale = 'zhCn' //ä¸­æ–‡
i18n.locale = 'en' //è‹±æ–‡
```


#### view ç”¨äºå­˜æ”¾æ‰€æœ‰çš„é¡µé¢
1. æ–‡ä»¶å¤¹å‘½åè§„èŒƒ ä¸²å¼å‘½å monitor-radar
1. æ–‡ä»¶å¤¹ä¸‹index.vueä»¥åŠå­æ¨¡å—
1. index.vue domæ¨¡æ¿åˆ›å»º
```typescript
<template>

</template>

<script lang="ts" setup>

</script>

<style scoped lang="less">

</style>

#### router.ts é¡µé¢è·¯ç”±
  
```typescript
export const routeList: Array<RouteRecordRaw> = [
  {
    path: '/',
    redirect: '/home'
  }, {
    path: '/home',
    name: 'home',
    meta: {
      title: 'é¦–é¡µ'
    },
    component: () => import('./view/home/index.vue')
  }, {
    path: '/suntray',
    name: 'æ§åˆ¶å°',
    component: () => import('@/view/control/index.vue'),
    redirect: '/suntray/my-apply',
    children: [
      {
        path: 'my-apply',
        name: 'æˆ‘çš„åº”ç”¨',
        component: () => import('@/view/control/my-apply/index.vue')
      },
      {
        path: 'my-service',
        name: 'æˆ‘çš„æœåŠ¡',
        component: () => import('@/view/control/my-service/index.vue')
      }
    ]
  },]
```

### .env.developmentä¸.env.production
å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒ
ä½¿ç”¨å…¨å±€å˜é‡
.env.development
```typescript
VITE_NODE_ENV = 'development'
VITE_APP_MAP_IP = ''
```
.env.production
```typescript
VITE_NODE_ENV = 'production'
VITE_APP_MAP_IP = '10.104.192.14'
```
->ä½¿ç”¨
```typescript
import.meta.env.VITE_APP_MAP_IP 
```

### vite.config.js
1. server.proxy é…ç½®ä»£ç†
```typescript
//ä»£ç†
'/data': {
  target: 'http://10.104.235.42:9990',
  changeOrigin: true,
  ws: true
}
  ```
1. base å¼€å‘æˆ–ç”Ÿäº§ç¯å¢ƒæœåŠ¡çš„å…¬å…±åŸºç¡€è·¯å¾„
```typescript
//æ–‡ä»¶ä¸­æ·»åŠ é…ç½®
base: '/hbweb/typhoon/'
//æ‰“åŒ…åçš„æ–‡ä»¶
<link rel="stylesheet" href="/hbweb/typhoon/assets/index.7676276e.css">
  ```


## ç›¸å…³é“¾æ¥
æºé…ç½®ï¼šhttp://wiki.hxgis.com/zh/public/docs/hxlc-ui/new-page
å‰ç«¯å¼€å‘è§„èŒƒï¼šhttp://wiki.hxgis.com/zh/public/docs/web-development-guide
ç»„ä»¶é€šä¿¡ï¼šhttps://juejin.cn/post/7161718828970278949
piniaä¸­æ–‡æ–‡æ¡£ï¼šhttps://pinia.web3doc.top/
vue3ä¸­æ–‡æ–‡æ¡£ï¼šhttps://cn.vuejs.org/
vue3ç”Ÿå‘½å‘¨æœŸï¼šhttp://wiki.hxgis.com/zh/public/docs/new-page






 







